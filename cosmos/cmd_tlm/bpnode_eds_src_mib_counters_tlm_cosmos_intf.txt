<%= dtnfsw_tlm_hdr(target_name, 'BPNODE_SOURCE_MIB_COUNTERS_HK', 1, "BPNode SOURCE MIB Counters Tlm") %>
    <% $dtnfsw_globals_max_num_mib_sets.times do |src_id| %>
        <% $dtnfsw_globals_num_eid_patterns_per_mib_set.times do |key_num| %>
            APPEND_ITEM EID<%=src_id%>_KEY<%=key_num%>_SCHEME         64 UINT "The pattern's expected scheme for matching purposes"
            APPEND_ITEM EID<%=src_id%>_KEY<%=key_num%>_IPN_SSP_FORMAT 64 UINT "The pattern's expected IPN SSP format for matching purposes"
            APPEND_ITEM EID<%=src_id%>_KEY<%=key_num%>_MAX_ALLOCATOR  64 UINT "The pattern's expected maximum allocator value for matching purposes"
            APPEND_ITEM EID<%=src_id%>_KEY<%=key_num%>_MIN_ALLOCATOR  64 UINT "The pattern's expected minimum allocator value for matching purposes"
            APPEND_ITEM EID<%=src_id%>_KEY<%=key_num%>_MAX_NODE       64 UINT "The pattern's expected maximum node value for matching purposes"
            APPEND_ITEM EID<%=src_id%>_KEY<%=key_num%>_MIN_NODE       64 UINT "The pattern's expected minimum node value for matching purposes"
            APPEND_ITEM EID<%=src_id%>_KEY<%=key_num%>_MAX_SERVICE    64 UINT "The pattern's expected maximum service value for matching purposes"
            APPEND_ITEM EID<%=src_id%>_KEY<%=key_num%>_MIN_SERVICE    64 UINT "The pattern's expected minimum service value for matching purposes"
        <% end %>

        APPEND_ITEM ACTIVE_KEYS_<%=src_id%>                               8 UINT "Tracks how many keys are actively being used"
        APPEND_ITEM SPARE_1_<%=src_id%>                                   8 UINT "Spare for alignment"
        APPEND_ITEM SPARE_2_<%=src_id%>                                  16 UINT "Spare for alignment"
        APPEND_ITEM ADU_COUNT_DELIVERED_<%= src_id %>                    32 UINT "Number of ADUs Delivered to the application"
        APPEND_ITEM ADU_COUNT_RECEIVED_<%= src_id %>                     32 UINT "Number of ADUs Received from the application"
        APPEND_ITEM BUNDLE_COUNT_ABANDONED_<%= src_id %>                 32 UINT "Number of Abandoned Bundle Payloads"
        APPEND_ITEM BUNDLE_COUNT_CUSTODY_REJECTED_<%= src_id %>          32 UINT "Number of unsuccessful Custody Transfers from the Local node to the next neighboring Custodian Node"
        APPEND_ITEM BUNDLE_COUNT_CUSTODY_REQUEST_<%= src_id %>           32 UINT "Number of bundles received that are requesting Custody Transfer"
        APPEND_ITEM BUNDLE_COUNT_CUSTODY_RE_FORWARDED_<%= src_id %>      32 UINT "Number of Bundles reforward due to custody timeout"
        APPEND_ITEM BUNDLE_COUNT_CUSTODY_TRANSFERRED_<%= src_id %>       32 UINT "Number of successful Custody Transfers from the Local node to the next neighboring Custodian Node"
        APPEND_ITEM BUNDLE_COUNT_DELETED_<%= src_id %>                   32 UINT "Total Number of Bundle Deletions"
        APPEND_ITEM BUNDLE_COUNT_DELETED_BAD_EID_<%= src_id %>           32 UINT "Number of Bundles deleted due to having a unrecognized destination EID"
        APPEND_ITEM BUNDLE_COUNT_DELETED_CANCELLED_<%= src_id %>         32 UINT "Number of Bundles Deletions due to Transmission Cancelled Condition"
        APPEND_ITEM BUNDLE_COUNT_DELETED_EXPIRED_<%= src_id %>           32 UINT "Number of Bundles Deletions due to Lifetime Expired Condition"
        APPEND_ITEM BUNDLE_COUNT_DELETED_FORWARD_FAILED_<%= src_id %>    32 UINT "Number of Bundles Deletions due to Forwarding Failed Condition"
        APPEND_ITEM BUNDLE_COUNT_DELETED_HOP_EXCEEDED_<%= src_id %>      32 UINT "Number of Bundles Deletions due to Hop Limit Exceeded Condition"
        APPEND_ITEM BUNDLE_COUNT_DELETED_INVALID_PAYLOAD_<%= src_id %>   32 UINT "Number of Bundle Deletions due having a Corrupted Payload Block"
        APPEND_ITEM BUNDLE_COUNT_DELETED_NO_STORAGE_<%= src_id %>        32 UINT "Number of Bundles deleted due to insufficient storage"
        APPEND_ITEM BUNDLE_COUNT_DELETED_TOO_LONG_<%= src_id %>          32 UINT "Number of Bundles deleted due to being longer than paramSetMaxBundleLength"
        APPEND_ITEM BUNDLE_COUNT_DELETED_TRAFFIC_PARED_<%= src_id %>     32 UINT "Number of Bundles Deletions due to Traffic Pared Condition"
        APPEND_ITEM BUNDLE_COUNT_DELETED_UNAUTHORIZED_<%= src_id %>      32 UINT "Number of Bundles deleted due to having a unrecognized source EID. Incremented if the bundle is not in the set of authorized source EIDs configured for the node."
        APPEND_ITEM BUNDLE_COUNT_DELETED_UNINTELLIGIBLE_<%= src_id %>    32 UINT "Number of Bundles Deletions due to Block Unintelligible Condition"
        APPEND_ITEM BUNDLE_COUNT_DELETED_UNSUPPORTED_BLOCK_<%= src_id %> 32 UINT "Number of Bundles Deletions due to Unsupported Block Condition"
        APPEND_ITEM BUNDLE_COUNT_DELIVERED_<%= src_id %>                 32 UINT "Total number of Bundles Delivered to this node, including fragments"
        APPEND_ITEM BUNDLE_COUNT_DEPLETED_<%= src_id %>                  32 UINT "Number of bundles for which rejected Custody Signals generated indicating rejection due to depleted storage"
        APPEND_ITEM BUNDLE_COUNT_DISCARDED_<%= src_id %>                 32 UINT "Number of Bundles Discarded"
        APPEND_ITEM BUNDLE_COUNT_FORWARDED_<%= src_id %>                 32 UINT "Number of Bundles Forwarded to another DTN Node"
        APPEND_ITEM BUNDLE_COUNT_FORWARDED_FAILED_<%= src_id %>          32 UINT "Number of Bundles where forwarding to another DTN Node failed"
        APPEND_ITEM BUNDLE_COUNT_FRAGMENTED_<%= src_id %>                32 UINT "Number of Bundles that needed to be Fragmented"
        APPEND_ITEM BUNDLE_COUNT_FRAGMENT_ERROR_<%= src_id %>            32 UINT "Number of Fragments discarded due to bad offset or ADU length"
        APPEND_ITEM BUNDLE_COUNT_GENERATED_ACCEPTED_<%= src_id %>        32 UINT "Number of Accepted Bundle Transmission Requests"
        APPEND_ITEM BUNDLE_COUNT_GENERATED_CUSTODY_SIGNAL_<%= src_id %>  32 UINT "Number of bundles for which Custody Signals Generated"
        APPEND_ITEM BUNDLE_COUNT_GENERATED_FRAGMENT_<%= src_id %>        32 UINT "Number of Bundle Fragments that were Generated"
        APPEND_ITEM BUNDLE_COUNT_GENERATED_REJECTED_<%= src_id %>        32 UINT "Number of Rejected Bundle Transmission Requests"
        APPEND_ITEM BUNDLE_COUNT_MAX_BSR_RATE_EXCEEDED_<%= src_id %>     32 UINT "Number of BSR bundles not sent because sending would exceed a maximum rate."
        APPEND_ITEM BUNDLE_COUNT_NO_CONTACT_<%= src_id %>                32 UINT "Number of bundles for which rejected Custody Signals generated indicating the Destination is not reachable before the Bundle expires"
        APPEND_ITEM BUNDLE_COUNT_NO_FURTHER_INFO_<%= src_id %>           32 UINT "Number of bundles for which successful Custody Signals generated with No Further Information"
        APPEND_ITEM BUNDLE_COUNT_NO_ROUTE_<%= src_id %>                  32 UINT "Number of bundles for which rejected Custody Signals generated indicating the Destination is not reachable"
        APPEND_ITEM BUNDLE_COUNT_REASSEMBLED_<%= src_id %>               32 UINT "Total number of Bundles delivered that were fragments and needed to be reassembled"
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_<%= src_id %>                  32 UINT "Number of Bundles Received from another DTN Node"
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_ADMIN_RECORD_<%= src_id %>     32 UINT "Number of admin record bundles received for this DTN Node."
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_BSR_ACCEPTED_<%= src_id %>     32 UINT "Number of Bundle Custody Accepted Status Report received since the last counter reset"
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_BSR_DELETED_<%= src_id %>      32 UINT "Number of Bundle Deleted Status Report received since the last counter reset"
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_BSR_DELIVERED_<%= src_id %>    32 UINT "Number of Bundle Delivered Status Report received since the last counter reset"
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_BSR_FORWARDED_<%= src_id %>    32 UINT "Number of Bundle Forwarded Status Report received since the last counter reset"
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_BSR_RECEIVED_<%= src_id %>     32 UINT "Number of Bundle Reception Status Report received since the last counter reset"
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_CRS_ACCEPTED_<%= src_id %>     32 UINT "Number of accepted bundle reports included in received Compressed Reporting Signals (CRSs) since the last counter reset. Also includes total number of accepted bundles per source node ID."
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_CRS_DELETED_<%= src_id %>      32 UINT "Number of deleted bundle reports included in received Compressed Reporting Signals (CRSs) since the last counter reset. Also includes total number of deleted bundles per source node ID."
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_CRS_DELIVERED_<%= src_id %>    32 UINT "Number of delivered bundle reports included in received Compressed Reporting Signals (CRSs) since the last counter reset. Also includes total number of delivered bundles per source node ID."
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_CRS_FORWARDED_<%= src_id %>    32 UINT "Number of forwarded bundle reports included in received Compressed Reporting Signals (CRSs) since the last counter reset. Also includes total number of forwarded bundles per source node ID."
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_CRS_RECEIVED_<%= src_id %>     32 UINT "Number of received bundle reports included in received Compressed Reporting Signals (CRSs) since the last counter reset. Also includes total number of received bundles per source node ID."
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_CUSTODY_SIGNAL_<%= src_id %>   32 UINT "Number of bundles for which Custody Signals Received"
        APPEND_ITEM BUNDLE_COUNT_RECEIVED_FRAGMENT_<%= src_id %>         32 UINT "Number of Bundles Received that were Marked as Fragments"
        APPEND_ITEM BUNDLE_COUNT_REDUNDANT_<%= src_id %>                 32 UINT "Number of bundles for which successful Custody Signals generated for Duplicate Bundle reception"
        APPEND_ITEM BUNDLE_COUNT_REJECTED_CUSTODY_<%= src_id %>          32 UINT "Number of Bundles where this node rejected custody."
        APPEND_ITEM BUNDLE_COUNT_RETURNED_<%= src_id %>                  32 UINT "Number of Bundles Returned to Sender"
        APPEND_ITEM BUNDLE_COUNT_UNINTELLIGIBLE_BLOCK_<%= src_id %>      32 UINT "Number of bundles for which Custody Signals indicating the Bundle contained an unknown block type"
        APPEND_ITEM BUNDLE_COUNT_UNINTELLIGIBLE_EID_<%= src_id %>        32 UINT "Number of bundles for which rejected Custody Signals generated indicating the any EID in the Primary Header is unknown"
        APPEND_ITEM BUNDLE_COUNT_UNPROCESSED_BLOCKS_<%= src_id %>        32 UINT "Number of Unprocessed Blocks Removed from Received Bundles"
        APPEND_ITEM SPARE_3_<%=src_id%>                                  32 UINT "Spare for alignment"
    <% end %>
    
    APPEND_ITEM TIME_MONOTONIC_CNT     64 INT  "Monotonic Time Counter"
    APPEND_ITEM TIME_CF                64 INT  "Time Correlation Factor (CF)"

    ITEM DTN_TIME_RAW                         0 0 DERIVED "DTN Timestamp (raw)"
        READ_CONVERSION dtn_time_raw_conversion.rb TIME_MONOTONIC_CNT TIME_CF
    ITEM DTN_TIME_FORMATTED                  0 0 DERIVED "DTN Timestamp (formatted)"
        READ_CONVERSION dtn_time_formatted_conversion.rb TIME_MONOTONIC_CNT TIME_CF
